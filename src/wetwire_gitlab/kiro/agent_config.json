{
  "name": "wetwire-gitlab-runner",
  "description": "GitLab CI/CD pipeline generator using wetwire-gitlab Python syntax",
  "allowedTools": ["fs_read", "fs_write", "bash", "mcp:wetwire-gitlab-mcp"],
  "context": {
    "patterns": "wetwire-gitlab Syntax Principles:\n\n1. JOBS - Define using Job dataclass:\n   ```python\n   from wetwire_gitlab.pipeline import Job, Artifacts, Cache, Rule\n   from wetwire_gitlab.intrinsics import CI, When, Rules\n\n   build = Job(\n       name=\"build\",\n       stage=\"build\",\n       script=[\"make build\"],\n       artifacts=Artifacts(paths=[\"build/\"]),\n   )\n   ```\n\n2. PIPELINES - Define Pipeline configuration:\n   ```python\n   from wetwire_gitlab.pipeline import Pipeline\n\n   pipeline = Pipeline(stages=[\"build\", \"test\", \"deploy\"])\n   ```\n\n3. TYPED VARIABLES - Use CI.*, GitLab.*, MR.* namespaces:\n   ```python\n   CI.COMMIT_SHA          # $CI_COMMIT_SHA\n   CI.DEFAULT_BRANCH      # $CI_DEFAULT_BRANCH\n   GitLab.USER_LOGIN      # $GITLAB_USER_LOGIN\n   MR.SOURCE_BRANCH       # $CI_MERGE_REQUEST_SOURCE_BRANCH_NAME\n   ```\n\n4. PREDEFINED RULES - Use Rules constants:\n   ```python\n   deploy = Job(\n       name=\"deploy\",\n       rules=[Rules.ON_DEFAULT_BRANCH],\n   )\n   ```\n\n5. WHEN CONSTANTS - Use typed When values:\n   ```python\n   When.MANUAL      # 'manual'\n   When.ALWAYS      # 'always'\n   When.ON_SUCCESS  # 'on_success'\n   ```\n\n6. IMAGES AND SERVICES - Use typed constants:\n   ```python\n   from wetwire_gitlab.intrinsics import Images, Services\n\n   job = Job(\n       name=\"test\",\n       image=Images.PYTHON_3_12,\n       services=[Services.POSTGRES_15, Services.REDIS_7],\n   )\n   ```\n\n7. JOB DEPENDENCIES - Use direct references:\n   ```python\n   build = Job(name=\"build\", stage=\"build\", script=[\"make build\"])\n   test = Job(name=\"test\", stage=\"test\", script=[\"make test\"], needs=[build])\n   ```",
    "lintRules": "Lint Rules (WGL001-WGL025):\n\n- WGL001-006: Use typed dataclasses (Rule, Cache, Artifacts, Image, Service, Stage)\n- WGL003: Use predefined variables from intrinsics (CI, GitLab, MR)\n- WGL007-008: File-level rules (duplicate names, too many jobs)\n- WGL009-010: Use predefined Rules and When constants\n- WGL011-023: Job validation (missing stage, script, name, needs, image, etc.)\n- WGL024: Circular dependency detection in job needs\n- WGL025: Secret pattern detection (hardcoded API keys, tokens, passwords)",
    "workflow": "Design Workflow:\n\n1. INIT - Create package with wetwire_init tool:\n   wetwire_init(path=\".\", module_name=\"my_pipeline\")\n\n2. CREATE FILES - Create jobs.py, stages.py, pipeline.py:\n   NEVER modify __init__.py - it is auto-generated\n\n3. LINT - Always run lint after editing:\n   wetwire_lint(path=\"./my_pipeline\")\n\n4. FIX-LINT LOOP - If lint has errors:\n   a. Fix the errors in code\n   b. Run wetwire_lint AGAIN\n   c. Repeat until zero errors\n\n5. BUILD - Only after lint passes:\n   wetwire_build(path=\"./my_pipeline\")\n\nCRITICAL RULES:\n- NEVER run wetwire_build until wetwire_lint passes with zero errors\n- After EVERY fix, re-run wetwire_lint\n- NEVER modify __init__.py under any circumstances\n- NEVER delete directories or start over - always fix in place"
  }
}
